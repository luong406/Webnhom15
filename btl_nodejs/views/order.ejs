<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />

  <title>Trang Chủ</title>
  <meta content="" name="description" />
  <meta content="" name="keywords" />

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,600,700|Raleway:300,400,400i,500,500i,700,800,900"
    rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <link href="vendor/animate.css/animate.min.css" rel="stylesheet" />
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
  <link href="vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />
  <link href="vendor/boxicons/css/boxicons.min.css" rel="stylesheet" />
  <link href="vendor/glightbox/css/glightbox.min.css" rel="stylesheet" />
  <link href="vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="css/styleHome.css" rel="stylesheet" />
</head>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f4;
  }

  .container {
    max-width: 1200px;
    margin: 50px auto;
    padding: 20px;
    display: flex;
    justify-content: space-between;
  }

  .checkout-container {
    display: flex;
    justify-content: space-between;
    width: 100%;
    gap: 20px;
  }

  .billing-info,
  .order-summary {
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  }

  .billing-info {
    width: 60%;
  }

  .billing-info h2,
  .order-summary h2 {
    font-size: 24px;
    color: #b91d1d;
    margin-bottom: 20px;
  }

  .billing-info label {
    display: block;
    margin-bottom: 8px;
    font-weight: bold;
  }

  .billing-info input,
  .billing-info textarea {
    width: 100%;
    padding: 10px;
    margin-bottom: 20px;
    border: 1px solid #ddd;
    border-radius: 5px;
  }

  .billing-info textarea {
    resize: vertical;
    height: 100px;
  }

  .create-account {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
  }

  .create-account input {
    margin-right: 10px;
  }

  .order-summary {
    width: 35%;
  }

  .order-summary table {
    width: 100%;
    border-collapse: collapse;
  }

  .order-summary th,
  .order-summary td {
    text-align: left;
    padding: 10px;
    border-bottom: 1px solid #ddd;
  }

  .order-summary th {
    font-weight: bold;
  }

  .payment-methods label {
    display: block;
    margin-bottom: 15px;
  }

  .payment-methods input {
    margin-right: 10px;
  }

  .payment-methods p {
    margin-left: 25px;
    font-size: 14px;
    color: #666;
  }

  .btn-order {
    display: block;
    width: 100%;
    padding: 15px;
    background-color: #b91d1d;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 18px;
    cursor: pointer;
    margin-top: 20px;
  }

  .btn-order:hover {
    background-color: #a11b1b;
  }
</style>

<body>
  <header id="header" class="fixed-top d-flex align-items-center">
    <div class="container d-flex justify-content-between">
      <div class="logo">
        <h1>
          <a href="index.html"><span>PTIT</span> FOOD</a>
        </h1>
      </div>

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto active" href="/">Trang Chủ</a></li>

          <li><a class="nav-link scrollto" href="cart">Giỏ hàng</a></li>

          <% if (!isAuthenticated) { %>
            <li><a class="nav-link scrollto" href="login">Đăng Nhập</a></li>
            <% } else { %>
              <li>
                <a class="nav-link scrollto" href="profile">Trang cá nhân</a>
              </li>
              <!-- Hiển thị nút khác nếu đã đăng nhập, ví dụ nút Đăng Xuất -->
              <li><a class="nav-link scrollto" href="logout">Đăng Xuất</a></li>
              <% } %>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav>
      <!-- .navbar -->
    </div>
  </header>
  <div class="container">
    <div class="checkout-container">
      <!-- Thông tin thanh toán -->
      <div class="billing-info">
        <h2>THÔNG TIN THANH TOÁN</h2>
        <form>
          <label for="name">Họ Tên *</label>
          <input type="text" id="name" placeholder="Họ tên" required>

          <label for="address">Địa chỉ *</label>
          <input type="text" id="address" placeholder="Địa chỉ"  value="<%= user.address %>" required>

          <label for="phone">Số điện thoại *</label>
          <input type="text" id="phone" placeholder="Số điện thoại"  value="<%= user.phone_number %>" required>

          <label for="email">Địa chỉ email *</label>
          <input type="email" id="email" placeholder="Email" required>

          <label for="descrip">Thông tin bổ sung *</label>
          <textarea id="descrip"
            placeholder="Ghi chú về đơn hàng, ví dụ: thời gian hay chỉ dẫn địa điểm giao hàng chi tiết hơn"></textarea>
        </form>
      </div>

      <!-- Đơn hàng của bạn -->
      <div class="order-summary">
        <h2>ĐƠN HÀNG CỦA BẠN</h2>
        <table class="order-table">
          <tr>
            <th>SẢN PHẨM</th>
            <th>Số Lượng</th>

            <th>Gia</th>
          </tr>
          <% if (order && order.length > 0) { %>
            <% order.forEach(item => { %>
              <tr>
                <td>Mã sản phẩm: <%= item.product_id %></td>
                <td><%= item.quantity %></td>
                <td><%= item.price.toLocaleString() %> ₫</td>
              </tr>
            <% }) %>
          <% } else { %>
            <tr>
              <td colspan="3">Giỏ hàng trống</td>
            </tr>
          <% } %>
    
          <tr>
            <th>Tạm tính</th>
            <td></td>
            <td> <%= order.reduce((total, item) => total + (item.quantity * item.price), 0).toLocaleString() %> ₫</td>
          </tr>
          <tr>
            <th>Tổng</th>
            <td></td>
            <td> <%= order.reduce((total, item) => total + (item.quantity * item.price), 0).toLocaleString() %> ₫</td>
          </tr>
        </table>

        <h3>Hình thức thanh toán</h3>
        <div class="payment-methods">
         

          <label>
            <input type="radio" name="payment" value="cod"> Trả tiền mặt khi nhận hàng
            <p>Thanh toán khi nhận hàng tại địa chỉ giao hàng của bạn.</p>
          </label>
        </div>

        <button class="btn-order" >ĐẶT HÀNG</button>
      </div>
    </div>
  </div>
  <footer>
    <div class="footer-area">
      <div class="container">
        <div class="row">
          <div class="col-xl-2">
            <div class="footer-content">
              <div class="footer-head">
                <div class="footer-logo">
                  <h2><span>PTIT</span>FOOD</h2>
                </div>

                <p style="text-align: justify;">
                  Chúng tôi là một cửa hàng bánh ngọt tại PTIT. Tại PTIT FOOD, mỗi chiếc bánh đều được làm thủ công với
                  sự tỉ mỉ và đam mê, mang đến hương vị ngọt ngào, độc đáo. Hãy để chúng tôi biến mỗi khoảnh khắc của
                  bạn trở nên đặc biệt hơn với hương vị từ PTIT FOOD
                </p>
                <div class="footer-icons">
                  <ul>
                    <li>
                      <a href="#"><i class="bi bi-facebook"></i></a>
                    </li>
                    <li>
                      <a href="#"><i class="bi bi-twitter"></i></a>
                    </li>
                    <li>
                      <a href="#"><i class="bi bi-instagram"></i></a>
                    </li>
                    <li>
                      <a href="#"><i class="bi bi-linkedin"></i></a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <!-- end single footer -->
          <div class="col-xl-4">
            <div class="footer-content">
              <div class="footer-head">
                <h4>FaceBook</h4>
                <iframe
                  src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2Fsomedia.vn.2016&tabs=timeline&width=340&height=500&small_header=true&adapt_container_width=true&hide_cover=false&show_facepile=true&appId"
                  width="340" height="300" style="border: none; overflow: hidden" scrolling="no" frameborder="0"
                  allowfullscreen="true"
                  allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"></iframe>
              </div>
            </div>
          </div>
          <!-- end single footer -->
          <div class="col-xl-6">
            <div class="footer-content">
              <div class="footer-head">
                <h4>Youtobe</h4>
                <iframe width="560" height="315" src="https://www.youtube.com/embed/DFsnYXtRveI?si=VRtoS0lLQeVrjBHC"
                  title="YouTube video player" frameborder="0"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                  referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="footer-area-bottom">
      <div class="container">
        <div class="row">
          <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="copyright text-center">
              <p>
                &copy; Copyright <strong>PTIT FOOD</strong>. All Rights
                Reserved
              </p>
            </div>
            <div class="credits">
              Designed by
              <a href="/">PhuongNgo</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
</body>
<script>
   document.querySelector('.btn-order').addEventListener('click', function (event) {
    // Ngăn không cho form submit nếu cần thiết
     event.preventDefault();
    console.log("1");
    // Lấy dữ liệu từ các trường form
    var name = document.getElementById('name').value;
    var address = document.getElementById('address').value;
    var phone = document.getElementById('phone').value;
    var email = document.getElementById('email').value;
    var descrip = document.getElementById('descrip').value;

    // 

    // Tạo đối tượng chứa dữ liệu
    var orderDataUser = { 
      full_name: name,
      address: address,
      phone_number: phone,
      email: email,
      descrip: descrip
    
    };
    console.log(orderDataUser);

    // Gửi dữ liệu qua phương thức POST bằng AJAX (hoặc fetch API)
    fetch('/order', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ orderDataUser})
    })
    .then(response => response.json())
    .then(data => {
      if (data.message === "Đặt hàng thành công") {
        alert("Đặt hàng thành công!"); // Hiển thị thông báo
        // Chuyển hướng về trang chủ
        window.location.href = '/'; // Thay đổi đường dẫn nếu cần
      } else {
        alert(data.message); // Hiển thị thông báo lỗi
        console.error(data.message);
        window.location.href = '/';
      }
    })
    .catch((error) => {
      console.error('Error:', error);
    });
  });

</script>
</html>

